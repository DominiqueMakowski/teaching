<!DOCTYPE html>
<html lang="en"><head>
<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/tabby.min.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.4.549">

  <meta name="author" content="Dominique MakowskiD.Makowski@sussex.ac.uk">
  <title>Bayesian Statistics</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="index_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="index_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #e1e4e8; background-color: #24292e; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #e1e4e8; } /* Normal */
    code span.al { color: #ff5555; font-weight: bold; } /* Alert */
    code span.an { color: #6a737d; } /* Annotation */
    code span.at { color: #f97583; } /* Attribute */
    code span.bn { color: #79b8ff; } /* BaseN */
    code span.bu { color: #f97583; } /* BuiltIn */
    code span.cf { color: #f97583; } /* ControlFlow */
    code span.ch { color: #9ecbff; } /* Char */
    code span.cn { color: #79b8ff; } /* Constant */
    code span.co { color: #6a737d; } /* Comment */
    code span.cv { color: #6a737d; } /* CommentVar */
    code span.do { color: #6a737d; } /* Documentation */
    code span.dt { color: #f97583; } /* DataType */
    code span.dv { color: #79b8ff; } /* DecVal */
    code span.er { color: #ff5555; text-decoration: underline; } /* Error */
    code span.ex { color: #f97583; font-weight: bold; } /* Extension */
    code span.fl { color: #79b8ff; } /* Float */
    code span.fu { color: #b392f0; } /* Function */
    code span.im { color: #9ecbff; } /* Import */
    code span.in { color: #6a737d; } /* Information */
    code span.kw { color: #f97583; } /* Keyword */
    code span.op { color: #e1e4e8; } /* Operator */
    code span.ot { color: #b392f0; } /* Other */
    code span.pp { color: #f97583; } /* Preprocessor */
    code span.re { color: #6a737d; } /* RegionMarker */
    code span.sc { color: #79b8ff; } /* SpecialChar */
    code span.ss { color: #9ecbff; } /* SpecialString */
    code span.st { color: #9ecbff; } /* String */
    code span.va { color: #ffab70; } /* Variable */
    code span.vs { color: #9ecbff; } /* VerbatimString */
    code span.wa { color: #ff5555; } /* Warning */
  </style>
  <link rel="stylesheet" href="index_files/libs/revealjs/dist/theme/quarto.css">
  <link href="index_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="index_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="index_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="index_files/libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="index_files/libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="index_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-color="black" data-background-image="https://github.com/RealityBending/RealityBending.github.io/blob/main/assets/media/sussex.png?raw=true" data-background-opacity="0.2" class="quarto-title-block center">
  <h1 class="title">Bayesian Statistics</h1>
  <p class="subtitle"><strong>5. Bayes Factors</strong></p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
<sub>Dominique Makowski</sub><br><sub><sup><em>D.Makowski@sussex.ac.uk</em></sup></sub> 
</div>
</div>
</div>

</section>
<section id="recap" class="slide level2 center" data-background-color="#1A237E">
<h2>Recap</h2>
<ul>
<li class="fragment">We learned about the <strong>Bayes’ Theorem</strong>:
<ul>
<li class="fragment"><span class="math inline">\(P(H|X) =\frac{P(H)~P(X|H)}{P(X)}\)</span></li>
</ul></li>
<li class="fragment">And how it can be used to update our beliefs about a hypothesis given new data</li>
</ul>
<div class="fragment">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="index_files/figure-revealjs/unnamed-chunk-2-1.png" width="3000"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="final-nail-in-the-coffin-for-the-p-value" class="slide level2">
<h2>Final nail in the coffin for the <em>p</em>-value</h2>
<div class="columns">
<div class="column" style="width:50%;">
<!-- ![](img/LuciferLikesP.jpg){width="30%"} -->
<p><img data-src="img/BayesBurstsThePValueBalloon.jpg" style="width:45.0%"></p>
<ul>
<li class="fragment">Another thing often heard about the <em>p</em>-value is that it can only be used to <strong>reject</strong> the <strong>null hypothesis</strong> (effect = 0), not as an index of evidence <strong>in favour of the null</strong></li>
<li class="fragment">This is because the <em>p</em>-value, by definition, is <strong>uniformly distributed</strong> under the null hypothesis
<ul>
<li class="fragment">This means that, if the null hypothesis is true, all values of the <em>p</em>-value are equally likely; <em>p</em> = .001 is just as likely as <em>p</em> = 1</li>
</ul></li>
</ul>
</div><div class="column">
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb1-2"><a href="" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>) {</span>
<span id="cb1-3"><a href="" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb1-4"><a href="" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb1-5"><a href="" aria-hidden="true" tabindex="-1"></a>  test <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y)</span>
<span id="cb1-6"><a href="" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">c</span>(p, test<span class="sc">$</span>p.value)</span>
<span id="cb1-7"><a href="" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-8"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">p =</span> p) <span class="sc">|&gt;</span> </span>
<span id="cb1-10"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>p)) <span class="sc">+</span></span>
<span id="cb1-11"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">40</span>, <span class="at">color=</span><span class="st">"white"</span>, <span class="at">fill=</span><span class="st">"grey"</span>) <span class="sc">+</span></span>
<span id="cb1-12"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"p-values"</span>, <span class="at">y=</span><span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb1-13"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="index_files/figure-revealjs/unnamed-chunk-3-1.png" width="3000"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="evidence-against-the-null-hypothesis" class="slide level2">
<h2>Evidence against the null hypothesis?</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li class="fragment">Altough Frequentists recently came up with some workarounds (region of practical equivalence testing), it is still seen as a limitation of the Frequentist framework</li>
<li class="fragment">This is problematic in science because we are often interested in disproving a hypothesis, or proving that there is no effect</li>
<li class="fragment">Does Uncle Bayes have a trick in his hat?</li>
</ul>
</div><div class="column">
<p><img data-src="img/BayesMagic.jpg"></p>
</div>
</div>
</section>
<section id="the-likelihood-as-a-known-model" class="slide level2">
<h2>The “Likelihood” as a <em>known</em> model</h2>
<div class="columns">
<div class="column" style="font-size: 85%;">
<ul>
<li class="fragment"><strong>Bayes’ Theorem</strong>: <span class="math inline">\(P(H|data) =P(H)~P(data|H)\)</span>
<ul>
<li class="fragment">Bayes’ theorem relates the probability of a hypothesis (H) given some observed evidence (data X) to the probability of data given the hypothesis, as well as the prior probability of the hypothesis</li>
</ul></li>
<li class="fragment"><span class="math inline">\(P(data|H)\)</span> is the <strong>likelihood</strong> of the data given a hypothesis</li>
<li class="fragment">It typically corresponds to a “model of the world”</li>
<li class="fragment">In the previous example, we had “the model” of coin tosses. We know the likelihood of outcomes given various coin types because it corresponds to a physical reality (a fair coin gives 50% heads). So the “model” was obvious and easy to define.</li>
</ul>
</div><div class="column" style="font-size: 80%;">
<div class="fragment">
<p><img data-src="img/likelihood1.png"></p>
</div>
<ul>
<li class="fragment">Conceptually, in this experiment:
<ul>
<li class="fragment">The <strong>likelihood</strong> was a statistical model linking a parameter <strong><em>x</em></strong> (the probability by which a coin is biased towards heads: 0.3, 0.4, 0.5, 0.6, 0.7) to the outcome (heads).</li>
<li class="fragment">The <strong>prior</strong> corresponded to the distribution of our credibility across the different possible <strong><em>x</em></strong> values.</li>
<li class="fragment">The <strong>posterior</strong> corresponded to the updated distribution of our credibility across the different possible <strong><em>x</em></strong> values after observing the data (coin tosses).</li>
</ul></li>
</ul>
</div>
</div>
</section>
<section id="the-likelihood-as-a-model-with-probabilistic-parameters" class="slide level2">
<h2>The “Likelihood” as a model with <em>probabilistic</em> parameters</h2>
<div class="columns">
<div class="column" style="width:65%;">
<ul>
<li class="fragment">We often have general beliefs about probabilistic models.
<ul>
<li class="fragment"><em>What are the odds that more type of coints exist?</em></li>
<li class="fragment"><em>What are the odds that my model of the coin is True</em></li>
<li class="fragment">…</li>
</ul></li>
<li class="fragment">In practice, the model’s likelihood depends on uncertain parameter over which we have other priors, or a combination of priors (e.g., Intercept + Slope)</li>
</ul>
</div><div class="column" style="width:35%;">
<p><img data-src="img/likelihood2.png"></p>
</div>
</div>
<ul>
<li class="fragment">The “likelihood”, as well as the “hypothesis”, can represent different things (a statistical model, beliefs about whether a general hypothesis is True, etc.)</li>
<li class="fragment">Problems can be specified in different ways (it is flexible framework)</li>
<li class="fragment">In typical real-life statistical scenarios, the <strong>likelihood</strong> term <span class="math inline">\(P(data|H)\)</span> is very complex to establish mathematically (i.e., it is hard to compute/approximate it)</li>
<li class="fragment">But it is not impossible. And accessing the likelihood is very useful…</li>
</ul>
</section>
<section id="the-likelihood-summary" class="slide level2">
<h2>The “Likelihood”: Summary</h2>
<ul>
<li class="fragment">The likelihood <span class="math inline">\(P(data|H)\)</span> represents “the probability of the data given a hypothesis”</li>
<li class="fragment">This hypothesis can be:
<ul>
<li class="fragment">A statistical model with fixed and known parameters (e.g., <span class="math inline">\(y = 2x + 3\)</span>)</li>
<li class="fragment">A statistical model with unknown (probabilistic) parameters (e.g., <span class="math inline">\(y = \beta x + Intercept\)</span> with <span class="math inline">\(\beta \sim Normal(0, 1)\)</span> and <span class="math inline">\(Intercept \sim Normal(3, 2)\)</span>)</li>
<li class="fragment">Any other statement about the world (e.g., a hypothesis like “this model is <em>true</em>”)</li>
</ul></li>
<li class="fragment">Mathematically computing the value of <span class="math inline">\(P(data|H)\)</span> is hard (aside from the first case)</li>
</ul>
</section>
<section id="bayes-factor-bf" class="slide level2">
<h2>Bayes Factor (BF)</h2>
<ul>
<li class="fragment">Bayes’ theorem provides a natural way to test hypotheses and compare models. Suppose we have two competing hypotheses: <strong>H1</strong> and an alternative hypothesis <strong>H0</strong></li>
<li class="fragment">What if we compared the likelihood of the data given two competing hypotheses (i.e., models)?
<ul>
<li class="fragment"><span class="math inline">\(P(data|H_{0})\)</span> / <span class="math inline">\(P(data|H_{1})\)</span></li>
</ul></li>
<li class="fragment">This ratio of likelihoods is known as the <strong>Bayes Factor</strong> (BF)
<ul>
<li class="fragment">It quantifies the relative strength of evidence in favor of <strong>one hypothesis over another</strong> based on the observed evidence (data)</li>
<li class="fragment">It tells us how much more likely the data (evidence) is under one hypothesis compared to another (often taking into account prior probabilities in the definition of the likelihood model)</li>
</ul></li>
<li class="fragment"><span class="math inline">\(BF_{10} = \frac{P(data|H_{1})}{P(data|H_{0})}\)</span></li>
<li class="fragment"><span class="math inline">\(BF_{01} = \frac{P(data|H_{0})}{P(data|H_{1})}\)</span>
<ul>
<li class="fragment">Note the convention of writing what is the numerator</li>
</ul></li>
</ul>
<!-- - From Bayes' theorem, it follows that:  -->
<!-- - $\underbrace{\frac{P(H_1 | D)}{P(H_0 | D)}}_{posterior~odds} = \underbrace{\frac{P(D | H_1)}{P(D | H_0)}}_{Bayes~Factor} \cdot \underbrace{\frac{P(H_1)}{P(H_0)}}_{prior~odds}$ -->
</section>
<section id="bfs-with-bic-approximation" class="slide level2 scrollable">
<h2>BFs with BIC approximation</h2>
<ul>
<li class="fragment">The Bayes Factor is a ratio of likelihoods, which is often difficult to compute, especially for Bayesian models where parameters are themselves probabilistic</li>
<li class="fragment">Wagenmakers (2007)<sup>1</sup> <sub><sup><em>(one of the principal proponent of Bayes factors)</em></sup></sub> proposed an approximation of the Bayes Factor based on the <strong>Bayesian Information Criterion</strong> (BIC), that can easily be computed for traditional Frequentist models (e.g., linear models)</li>
<li class="fragment"><span class="math inline">\(BF_{01} \approx exp(\frac{BIC_{1} - BIC_{0}}{2})\)</span></li>
</ul>
<aside><ol class="aside-footnotes"><li id="fn1"><p>Wagenmakers, E. J. (2007). A practical solution to the pervasive problems of p values. Psychonomic bulletin &amp; review, 14(5), 779-804.</p></li></ol></aside></section>
<section id="model-0-qsec-mpg" class="slide level2">
<h2>Model 0: qsec ~ mpg</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mtcars[<span class="fu">c</span>(<span class="st">"mpg"</span>, <span class="st">"qsec"</span>, <span class="st">"wt"</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   mpg  qsec    wt
Mazda RX4         21.0 16.46 2.620
Mazda RX4 Wag     21.0 17.02 2.875
Datsun 710        22.8 18.61 2.320
Hornet 4 Drive    21.4 19.44 3.215
Hornet Sportabout 18.7 17.02 3.440
Valiant           18.1 20.22 3.460</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> </span>
<span id="cb4-2"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>mpg, <span class="at">y=</span>qsec)) <span class="sc">+</span></span>
<span id="cb4-3"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb4-4"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>, <span class="at">formula =</span> <span class="st">"y ~ x"</span>) <span class="sc">+</span></span>
<span id="cb4-5"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="index_files/figure-revealjs/unnamed-chunk-4-1.png" width="3000"></p>
</figure>
</div>
</div>
</div>
</div><div class="column">
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="" aria-hidden="true" tabindex="-1"></a>model0 <span class="ot">&lt;-</span> <span class="fu">lm</span>(qsec <span class="sc">~</span> mpg, <span class="at">data =</span> mtcars)</span>
<span id="cb5-2"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = qsec ~ mpg, data = mtcars)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.8161 -1.0287  0.0954  0.8623  4.7149 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 15.35477    1.02978  14.911 2.05e-15 ***
mpg          0.12414    0.04916   2.525   0.0171 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.65 on 30 degrees of freedom
Multiple R-squared:  0.1753,    Adjusted R-squared:  0.1478 
F-statistic: 6.377 on 1 and 30 DF,  p-value: 0.01708</code></pre>
</div>
</div>
</div>
<ul>
<li class="fragment"><code>mpg</code> is a significant predictor of <code>qsec</code> (<span class="math inline">\(\beta\)</span> = 0.12, <em>p</em> &lt; .05)</li>
<li class="fragment">Is it worth it to add another predictor? Does it improve the model?</li>
</ul>
</div>
</div>
</section>
<section id="model-1-qsec-mpg-wt" class="slide level2">
<h2>Model 1: qsec ~ mpg + wt</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> </span>
<span id="cb7-2"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>wt, <span class="at">y=</span>qsec)) <span class="sc">+</span></span>
<span id="cb7-3"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb7-4"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>, <span class="at">formula =</span> <span class="st">"y ~ x"</span>) <span class="sc">+</span></span>
<span id="cb7-5"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="index_files/figure-revealjs/unnamed-chunk-6-1.png" width="3000"></p>
</figure>
</div>
</div>
</div>
<ul>
<li class="fragment">Do you think adding <code>wt</code> will improve the model?</li>
</ul>
</div><div class="column">
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(qsec <span class="sc">~</span> mpg <span class="sc">+</span> wt, <span class="at">data =</span> mtcars)</span>
<span id="cb8-2"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = qsec ~ mpg + wt, data = mtcars)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.1092 -0.9617 -0.2343  0.8399  4.2769 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)  6.92949    3.53431   1.961   0.0596 . 
mpg          0.32039    0.09138   3.506   0.0015 **
wt           1.39324    0.56286   2.475   0.0194 * 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.524 on 29 degrees of freedom
Multiple R-squared:  0.3191,    Adjusted R-squared:  0.2722 
F-statistic: 6.797 on 2 and 29 DF,  p-value: 0.003796</code></pre>
</div>
</div>
</div>
<ul>
<li class="fragment">Be careful! A model with multiple predictors is different from individual models taken separately (because variables interact with each other)</li>
</ul>
</div>
</div>
<ul>
<li class="fragment">Is <strong>model1</strong> better than <strong>model0</strong>?</li>
<li class="fragment">Higher R2, but more parameters (more complex model). Comparing BICs is an alternative that takes into account the number of parameters</li>
</ul>
</section>
<section id="extract-bics" class="slide level2">
<h2>Extract BICs</h2>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="" aria-hidden="true" tabindex="-1"></a>perf0 <span class="ot">&lt;-</span> performance<span class="sc">::</span><span class="fu">performance</span>(model0)</span>
<span id="cb10-2"><a href="" aria-hidden="true" tabindex="-1"></a>perf0</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Indices of model performance

AIC     |    AICc |     BIC |    R2 | R2 (adj.) |  RMSE | Sigma
---------------------------------------------------------------
126.781 | 127.638 | 131.178 | 0.175 |     0.148 | 1.597 | 1.650</code></pre>
</div>
</div>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="" aria-hidden="true" tabindex="-1"></a>bic0 <span class="ot">&lt;-</span> perf0<span class="sc">$</span>BIC</span>
<span id="cb12-2"><a href="" aria-hidden="true" tabindex="-1"></a>bic0</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 131.1783</code></pre>
</div>
</div>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="" aria-hidden="true" tabindex="-1"></a>bic1 <span class="ot">&lt;-</span> performance<span class="sc">::</span><span class="fu">performance</span>(model1)<span class="sc">$</span>BIC</span>
<span id="cb14-2"><a href="" aria-hidden="true" tabindex="-1"></a>bic1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 128.5105</code></pre>
</div>
</div>
</div>
<ul>
<li class="fragment">Normally, the lower the BIC, the better the model</li>
<li class="fragment">Hard to interpret in absolute terms (the unit is meaningless), but we can compare models (if they are related to the same data)</li>
</ul>
</section>
<section id="compare-bics" class="slide level2">
<h2>Compare BICs</h2>
<ul>
<li class="fragment"><span class="math inline">\(BF_{10} \approx exp(\frac{BIC_{0} - BIC_{1}}{2})\)</span></li>
<li class="fragment">We can apply the formula to <code>bic1</code> and <code>bic0</code></li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="" aria-hidden="true" tabindex="-1"></a>bf10 <span class="ot">&lt;-</span> <span class="fu">exp</span>((bic0 <span class="sc">-</span> bic1) <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb16-2"><a href="" aria-hidden="true" tabindex="-1"></a>bf10</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.795896</code></pre>
</div>
</div>
</div>
<ul>
<li class="fragment">You computed an approximation of the Bayes Factor “by hand”!</li>
</ul>
</section>
<section id="using-bayestestr" class="slide level2">
<h2>Using <code>bayestestR</code></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="" aria-hidden="true" tabindex="-1"></a>bayestestR<span class="sc">::</span><span class="fu">bayesfactor_models</span>(model1, <span class="at">denominator=</span>model0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Bayes Factors for Model Comparison

         Model      BF
[model1] mpg + wt 3.80

* Against Denominator: [model0] mpg
*   Bayes Factor Type: BIC approximation</code></pre>
</div>
</div>
</section>
<section id="bf10-vs.-bf01" class="slide level2">
<h2>BF10 vs.&nbsp;BF01</h2>
<ul>
<li class="fragment">Bayes factors are a <strong>ratio</strong> of likelihood of data under some hypothesis</li>
<li class="fragment">They quantify “how much” the data is more likely under one model compared to another</li>
<li class="fragment"><span class="math inline">\(BF_{10} = 3.80\)</span> means the data is 3.80 times more likely under <strong>model1</strong> than <strong>model0</strong></li>
<li class="fragment"><strong>Importantly</strong>, BFs are “reversable”:</li>
<li class="fragment"><span class="math inline">\(BF_{01} = \frac{1}{BF_{10}} = 1 / 3.80 = 0.263\)</span></li>
<li class="fragment">The data is 0.26 times more likely under <strong>model0</strong> than <strong>model1</strong></li>
<li class="fragment">We gather evidence <strong>both ways</strong> (in <em>favour</em> or <em>against</em> a hypothesis)</li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="" aria-hidden="true" tabindex="-1"></a>bayestestR<span class="sc">::</span><span class="fu">bayesfactor_models</span>(model0, <span class="at">denominator=</span>model1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Bayes Factors for Model Comparison

         Model    BF
[model0] mpg   0.263

* Against Denominator: [model1] mpg + wt
*   Bayes Factor Type: BIC approximation</code></pre>
</div>
</div>
</div>
<ul>
<li class="fragment">Is this “big”? How to interpret BFs?</li>
</ul>
</section>
<section id="bayes-factor-interpretation" class="slide level2">
<h2>Bayes Factor Interpretation</h2>
<div style="font-size: 90%">
<ul>
<li class="fragment">The standard threshold for a “significant” BF is 3 or 10
<ul>
<li class="fragment"><em>Jeffreys, H. (1961), Theory of Probability, 3rd ed., Oxford University Press, Oxford</em></li>
</ul></li>
</ul>
<div class="fragment">
<table>
<thead>
<tr class="header">
<th>Bayes Factor (<span class="math inline">\(BF_{10}\)</span>)</th>
<th>Interpretation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>&gt; 100</td>
<td>Extreme evidence for H1</td>
</tr>
<tr class="even">
<td>30 – 100</td>
<td>Very strong evidence for H1</td>
</tr>
<tr class="odd">
<td>10 – 30</td>
<td>Strong evidence for H1</td>
</tr>
<tr class="even">
<td>3 – 10</td>
<td>Moderate evidence for H1</td>
</tr>
<tr class="odd">
<td>1 – 3</td>
<td>Anecdotal evidence for H1</td>
</tr>
<tr class="even">
<td>1</td>
<td>No evidence</td>
</tr>
<tr class="odd">
<td>1/3 – 1</td>
<td>Anecdotal evidence for H0</td>
</tr>
<tr class="even">
<td>1/3 – 1/10</td>
<td>Moderate evidence for null H0</td>
</tr>
<tr class="odd">
<td>1/10 – 1/30</td>
<td>Strong evidence for null H0</td>
</tr>
<tr class="even">
<td>1/30 – 1/100</td>
<td>Very strong evidence for H0</td>
</tr>
<tr class="odd">
<td>&lt; 1/100</td>
<td>Extreme evidence for H0</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="bayes-factor-interpretation-1" class="slide level2">
<h2>Bayes Factor Interpretation</h2>
<ul>
<li class="fragment">The <code>effectsize</code> package provides many automated interpretation functions</li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="" aria-hidden="true" tabindex="-1"></a>effectsize<span class="sc">::</span><span class="fu">interpret_bf</span>(bf10)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "moderate evidence in favour of"
(Rules: jeffreys1961)</code></pre>
</div>
</div>
</div>
<ul>
<li class="fragment">Note that because BFs can be very big or very small, they are sometimes presented on the log scale (<span class="math inline">\(log~BF_{10}\)</span>), in which case <strong>numbers smaller than 1 become negative</strong></li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(<span class="fl">3.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.335001</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(<span class="dv">1</span><span class="sc">/</span><span class="fl">3.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -1.335001</code></pre>
</div>
</div>
</div>
<ul>
<li class="fragment">To “unlog” a logged BF, use <code>exp()</code></li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(<span class="fl">3.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.335001</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fl">1.335001</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.8</code></pre>
</div>
</div>
</div>
</section>
<section id="exercice" class="slide level2" data-background-color="#FFAB91">
<h2>Exercice</h2>
<ul>
<li class="fragment">Compute the Bayes Factor for the following models: <code>qsec ~ wt</code> vs.&nbsp;a <strong>constant model</strong></li>
<li class="fragment">A constant model, aka an “intercept-only” model, is a model with no predictors (only an intercept)</li>
<li class="fragment">A constant model basically predicts the mean of the outcome variable for all observations</li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(mtcars<span class="sc">$</span>qsec)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 17.84875</code></pre>
</div>
</div>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="" aria-hidden="true" tabindex="-1"></a>model0 <span class="ot">&lt;-</span> <span class="fu">lm</span>(qsec <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> mtcars)</span>
<span id="cb34-2"><a href="" aria-hidden="true" tabindex="-1"></a>model0</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = qsec ~ 1, data = mtcars)

Coefficients:
(Intercept)  
      17.85  </code></pre>
</div>
</div>
</div>
<ul>
<li class="fragment">Compute the BF and interpret it. Make a conclusion</li>
</ul>
</section>
<section id="solution" class="slide level2">
<h2>Solution</h2>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(qsec <span class="sc">~</span> wt, <span class="at">data =</span> mtcars)</span>
<span id="cb36-2"><a href="" aria-hidden="true" tabindex="-1"></a>model1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = qsec ~ wt, data = mtcars)

Coefficients:
(Intercept)           wt  
    18.8753      -0.3191  </code></pre>
</div>
</div>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="" aria-hidden="true" tabindex="-1"></a>bayestestR<span class="sc">::</span><span class="fu">bayesfactor_models</span>(model1, <span class="at">denominator=</span>model0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Bayes Factors for Model Comparison

         Model    BF
[model1] wt    0.290

* Against Denominator: [model0] (Intercept only)
*   Bayes Factor Type: BIC approximation</code></pre>
</div>
</div>
</div>
<ul>
<li class="fragment">BF &lt; 1/3 (0.3333)</li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="" aria-hidden="true" tabindex="-1"></a>effectsize<span class="sc">::</span><span class="fu">interpret_bf</span>(<span class="fl">0.290</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "moderate evidence against"
(Rules: jeffreys1961)</code></pre>
</div>
</div>
</div>
</section>
<section id="exercice-2" class="slide level2" data-background-color="#FFAB91">
<h2>Exercice 2</h2>
<ul>
<li class="fragment">“I try to analyze the linear relationship between the sepal length and the sepal width of the iris flowers (<code>iris</code> built in dataset). Should I control for <em>Species</em>?”</li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Sepal.Length <span class="sc">~</span> Sepal.Width, <span class="at">data =</span> iris)</span>
<span id="cb42-2"><a href="" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Sepal.Length <span class="sc">~</span> Sepal.Width <span class="sc">+</span> Species, <span class="at">data =</span> iris)</span>
<span id="cb42-3"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="" aria-hidden="true" tabindex="-1"></a>bayestestR<span class="sc">::</span><span class="fu">bayesfactor_models</span>(m1, <span class="at">denominator=</span>m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Bayes Factors for Model Comparison

     Model             BF
[m1] Sepal.Width 2.96e-40

* Against Denominator: [m2] Sepal.Width + Species
*   Bayes Factor Type: BIC approximation</code></pre>
</div>
</div>
</div>
<ul>
<li class="fragment">Pizzas can help us get a intuitive feeling for BFs</li>
</ul>
</section>
<section id="section" class="slide level2" data-background-image="img/LetsPokeAPizza1.jpg" data-background-size="contain">
<h2>1</h2>
</section>
<section id="section-1" class="slide level2" data-background-image="img/LetsPokeAPizza2.jpg" data-background-size="contain">
<h2>2</h2>
</section>
<section id="pizza-plot" class="slide level2">
<h2>Pizza plot</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(bayestestR<span class="sc">::</span><span class="fu">bayesfactor_models</span>(model1, <span class="at">denominator=</span>model0)) <span class="sc">+</span></span>
<span id="cb44-2"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"yellow"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="index_files/figure-revealjs/unnamed-chunk-23-1.png" width="3000" class="r-stretch"></section>
<section id="t-tests" class="slide level2">
<h2><em>t</em>-Tests</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li class="fragment">True Bayes factor (i.e., not approximations using Frequentist models) can be also computed for “simple” tests, such as <em>t</em>-tests</li>
<li class="fragment"><em>t</em>-tests test for the difference of means of a variable between two groups (or against a constant value)</li>
<li class="fragment">This is a frequentist <em>t</em>-test:</li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># `am` is a binary variable (0 and 1)</span></span>
<span id="cb45-2"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(mtcars<span class="sc">$</span>mpg <span class="sc">~</span> mtcars<span class="sc">$</span>am)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  mtcars$mpg by mtcars$am
t = -3.7671, df = 18.332, p-value = 0.001374
alternative hypothesis: true difference in means between group 0 and group 1 is not equal to 0
95 percent confidence interval:
 -11.280194  -3.209684
sample estimates:
mean in group 0 mean in group 1 
       17.14737        24.39231 </code></pre>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">|&gt;</span> </span>
<span id="cb47-2"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fu">as.factor</span>(am), <span class="at">y=</span>mpg)) <span class="sc">+</span></span>
<span id="cb47-3"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width=</span><span class="fl">0.1</span>, <span class="at">size=</span><span class="dv">3</span>)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="index_files/figure-revealjs/unnamed-chunk-25-1.png" width="3000"></p>
</figure>
</div>
</div>
</div>
</div>
<ul>
<li class="fragment">We conclude that there is a significance difference between the two groups (am == 1 &gt; am == 0, <em>p</em> &lt; .01)</li>
</ul>
</div>
</div>
</section>
<section id="bayesian-t-tests" class="slide level2 scrollable">
<h2>Bayesian <em>t</em>-Tests</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li class="fragment">They are implemented in the <code>BayesFactor</code> package (by Richard Morey) where BFs are computed using a technique called <em>Gaussian Quadrature</em> <sup>1</sup> possible for simple models <sub><sup>(not important)<sub></sub></sup></sub></li>
<li class="fragment">The Bayes factor compares two hypotheses: that the standardized effect size is 0, or that the standardized effect size is not 0.</li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(BayesFactor)  <span class="co"># Case sensitive!</span></span>
<span id="cb48-2"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># Note the use of `formula` and `data` arguments</span></span>
<span id="cb48-4"><a href="" aria-hidden="true" tabindex="-1"></a>BayesFactor<span class="sc">::</span><span class="fu">ttestBF</span>(<span class="at">formula=</span>mpg <span class="sc">~</span> am, <span class="at">data=</span>mtcars)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Bayes factor analysis
--------------
[1] Alt., r=0.707 : 86.58973 ±0%

Against denominator:
  Null, mu1-mu2 = 0 
---
Bayes factor type: BFindepSample, JZS</code></pre>
</div>
</div>
</div>
</div><div class="column">
<ul>
<li class="fragment">What can we conclude?</li>
<li class="fragment"><span class="math inline">\(BF_{10}\)</span> = 86.59</li>
<li class="fragment">Very strong evidence in favour of the hypothesis that there is a non-null difference between the two groups</li>
<li class="fragment">What about priors?
<ul>
<li class="fragment">In this particular case, let’s just say that they are good enough “default” priors (there is a lot of literature justifying it). Can be used “as-is” without too much worry*</li>
<li class="fragment">*Some people will might lose it if they see this</li>
</ul></li>
</ul>
</div>
</div>
<aside><ol class="aside-footnotes"><li id="fn2"><p>Rouder, J. N., Speckman, P. L., Sun, D., Morey, R. D., &amp; Iverson, G. (2009). Bayesian <em>t</em>-tests for accepting and rejecting the null hypothesis. Psychonomic bulletin &amp; review, 16, 225-237.</p></li></ol></aside></section>
<section id="correlation-test" class="slide level2">
<h2>Correlation Test</h2>
<ul>
<li class="fragment">The <code>BayesFactor</code> package also implements correlation tests</li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(BayesFactor)  <span class="co"># Case sensitive!</span></span>
<span id="cb50-2"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-3"><a href="" aria-hidden="true" tabindex="-1"></a>BayesFactor<span class="sc">::</span><span class="fu">correlationBF</span>(mtcars<span class="sc">$</span>drat, mtcars<span class="sc">$</span>qsec)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Bayes factor analysis
--------------
[1] Alt., r=0.333 : 0.4322745 ±0%

Against denominator:
  Null, rho = 0 
---
Bayes factor type: BFcorrelation, Jeffreys-beta*</code></pre>
</div>
</div>
</div>
<ul>
<li class="fragment">What can we conclude?</li>
<li class="fragment"><span class="math inline">\(BF_{10}\)</span> = 0.43</li>
<li class="fragment">No evidence in favour of any models (that there is a null vs.&nbsp;non-null correlation)</li>
</ul>
</section>
<section id="priors" class="slide level2">
<h2>Priors</h2>
<ul>
<li class="fragment">Remember: the Bayes Factor is a ratio of the likelihood of the data under the two models</li>
<li class="fragment"><span class="math inline">\(\underbrace{\frac{P(H_1 | D)}{P(H_0 | D)}}_{posterior~odds} = \underbrace{\frac{P(D | H_1)}{P(D | H_0)}}_{Bayes~Factor} \cdot \underbrace{\frac{P(H_1)}{P(H_0)}}_{prior~odds}\)</span></li>
<li class="fragment">The likelhood can be interpreted as an <strong>updating factor</strong>: how much the data updated our prior beliefs
<ul>
<li class="fragment">In other words, how much did we move from Prior to Posterior</li>
</ul></li>
<li class="fragment">The stronger the BF, the stronger the “difference” between the <strong>prior</strong> and the <strong>posterior</strong></li>
<li class="fragment">But what is the prior?
<ul>
<li class="fragment">Remember, we are trying to estimate the correlation coefficient rho <span class="math inline">\(\rho\)</span> after seeing the data</li>
<li class="fragment">But we need to have a prior idea of what <span class="math inline">\(\rho\)</span> could be</li>
</ul></li>
<li class="fragment">How to specify a prior for <span class="math inline">\(\rho\)</span>?</li>
</ul>
</section>
<section id="prior-distribution" class="slide level2">
<h2>Prior Distribution</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li class="fragment">In the previous examples, we had priors in the form of discrete categories (e.g., 1/3 that the coin is fair, 1/3 that it’s rigged, …)</li>
</ul>
<div class="fragment">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="index_files/figure-revealjs/unnamed-chunk-28-1.png" width="3000"></p>
</figure>
</div>
</div>
</div>
</div>
<ul>
<li class="fragment">But how to specify a prior for a continuous variable like a correlation coefficient?</li>
<li class="fragment">Using a distribution!</li>
</ul>
</div><div class="column">
<ul>
<li class="fragment">Let’s imagine taking a normal distribution as a prior for <span class="math inline">\(\rho\)</span> (i.e., we think that <span class="math inline">\(\rho\)</span> is normally distributed)</li>
<li class="fragment">Imagine that someone proposes the following parameters
<ul>
<li class="fragment">e.g., <span class="math inline">\(\mu = 0.42, \sigma = 0.7\)</span></li>
</ul></li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="" aria-hidden="true" tabindex="-1"></a>xspace <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">1.5</span>, <span class="fl">1.5</span>, <span class="at">by=</span><span class="fl">0.01</span>)</span>
<span id="cb52-2"><a href="" aria-hidden="true" tabindex="-1"></a>prob <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(xspace, <span class="at">mean=</span><span class="fl">0.42</span>, <span class="at">sd=</span><span class="fl">0.333</span>)</span>
<span id="cb52-3"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> xspace, <span class="at">y =</span> prob) </span>
<span id="cb52-5"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-6"><a href="" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> </span>
<span id="cb52-7"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y)) <span class="sc">+</span></span>
<span id="cb52-8"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color=</span><span class="st">"blue"</span>, <span class="at">linewidth=</span><span class="dv">3</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="index_files/figure-revealjs/unnamed-chunk-29-1.png" width="3000"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="exercice-1" class="slide level2" data-background-color="#FFAB91">
<h2>Exercice</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li class="fragment">Do you think this is a good prior?</li>
<li class="fragment">Why is this not a very good prior?</li>
<li class="fragment">Try to come up with a suitable prior for the correlation coefficient <span class="math inline">\(\rho\)</span></li>
</ul>
</div><div class="column">
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="index_files/figure-revealjs/unnamed-chunk-30-1.png" width="3000"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="solution-1" class="slide level2" data-background-color="#80DEEA">
<h2>Solution</h2>
<div class="columns">
<div class="column" style="font-size: 80%;">
<ul>
<li class="fragment">Priors represent your beliefs <strong>before</strong> seeing the data
<ul>
<li class="fragment">In can be from previous studies, from your own experience, from your intuition, …</li>
</ul></li>
<li class="fragment">Do we have a hypothesis about the direction (positive vs.&nbsp;negative) of the correlation between <code>drat</code> and <code>qsec</code>
<ul>
<li class="fragment">No.&nbsp;The correlation could be positive or negative.</li>
</ul></li>
<li class="fragment">Do we have reasons to expect a non-null correlation?
<ul>
<li class="fragment">No.&nbsp;</li>
<li class="fragment">Our prior could be symmetric around 0, with a higher probability on 0 (i.e., we think that the correlation is more likely to be 0 than any other value)</li>
</ul></li>
</ul>
</div><div class="column" style="font-size: 80%;">
<ul>
<li class="fragment">What about <span class="math inline">\(Normal(0, 0.5)\)</span></li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>y <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(xspace, <span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span><span class="fl">0.5</span>) </span>
<span id="cb53-2"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-3"><a href="" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> </span>
<span id="cb53-4"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y)) <span class="sc">+</span></span>
<span id="cb53-5"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color=</span><span class="st">"blue"</span>, <span class="at">linewidth=</span><span class="dv">3</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="index_files/figure-revealjs/unnamed-chunk-31-1.png" width="3000"></p>
</figure>
</div>
</div>
</div>
</div>
<ul>
<li class="fragment">What’s the problem?</li>
</ul>
</div>
</div>
</section>
<section id="priors-for-correlation-coefficients" class="slide level2">
<h2>Priors for Correlation Coefficients?</h2>
<ul>
<li class="fragment">Bayesian inference is, fundamentally, the process of reallocating <em>credibility</em> across candidate parameter values
<ul>
<li class="fragment">From prior to posterior</li>
</ul></li>
<li class="fragment">Priors <strong>should</strong> incorporate “domain knowledge” (critical for good Bayesian models)
<ul>
<li class="fragment">For example, knowledge about the range of possible values</li>
</ul></li>
<li class="fragment">We know that the correlation coefficient is bounded between -1 and 1 by definition. We should incorporate this knowledge in our prior and assign a probability of 0 to values outside of this range</li>
<li class="fragment">How can we do that?
<ul>
<li class="fragment">We could use a truncated normal distribution (e.g., <span class="math inline">\(Normal(0, 0.5)\)</span> truncated between -1 and 1)</li>
<li class="fragment">Or pick a distribution that has bounds</li>
</ul></li>
<li class="fragment">What is a distribution that has negative and positive bounds?</li>
</ul>
</section>
<section id="what-about-uniform" class="slide level2">
<h2>What about <em>Uniform</em>?</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li class="fragment"><span class="math inline">\(Uniform(-1, 1)\)</span> means that all values between -1 and 1 are equally likely</li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the uniform distribution</span></span>
<span id="cb54-2"><a href="" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>y <span class="ot">&lt;-</span> <span class="fu">dunif</span>(xspace, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>) </span>
<span id="cb54-3"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-4"><a href="" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> </span>
<span id="cb54-5"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>y)) <span class="sc">+</span></span>
<span id="cb54-6"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>x), <span class="at">color=</span><span class="st">"blue"</span>, <span class="at">linewidth=</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb54-7"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="index_files/figure-revealjs/unnamed-chunk-32-1.png" width="3000"></p>
</figure>
</div>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<ul>
<li class="fragment">This is a <strong>non-informative prior</strong>
<ul>
<li class="fragment">i.e., we don’t introduce any prior knowledge about the correlation coefficient (other than domain knowledge about what a correlation coefficient is)</li>
<li class="fragment">As we will see later, uniform priors tend to give results that are similar to frequentist maximum likelihood estimates (i.e., Bayesian models with uniform priors tend to have very similar results to frequentist models)</li>
</ul></li>
<li class="fragment">But they are non-recommended.
<ul>
<li class="fragment">They are often non realistic: we tend to have some expectations about our parameters, and priors should reflect these beliefs</li>
</ul></li>
</ul>
</div>
</div>
</section>
<section id="what-other-prior" class="slide level2">
<h2>What other prior?</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li class="fragment">What is another distribution that has bounds?
<ul>
<li class="fragment">The beta distribution!</li>
</ul></li>
<li class="fragment">But what’s the problem?
<ul>
<li class="fragment">It is defined on the interval [0, 1]</li>
</ul></li>
<li class="fragment">Solution?
<ul>
<li class="fragment">Distributions can often be <em>scaled</em> and <em>shifted</em></li>
</ul></li>
</ul>
</div><div class="column" style="width:50%;">
<p><img data-src="img/distributions.jpg"></p>
</div>
</div>
</section>
<section id="shifted-and-scaled-beta" class="slide level2">
<h2>Shifted and Scaled Beta</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li class="fragment">We can have a shifted &amp; scaled beta distribution that is defined on the interval [-1, 1] with a peak at 0</li>
<li class="fragment">E.g., How about <span class="math inline">\(Beta(1.5, 1.5)\)</span> rescaled and shifted to [-1, 1]?</li>
</ul>
</div><div class="column" style="width:50%;">
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the beta distribution</span></span>
<span id="cb55-2"><a href="" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>y <span class="ot">&lt;-</span> <span class="fu">dbeta</span>(xspace, <span class="fl">1.5</span>, <span class="fl">1.5</span>)</span>
<span id="cb55-3"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># Rescale its x-axis</span></span>
<span id="cb55-4"><a href="" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>x2 <span class="ot">&lt;-</span> (data<span class="sc">$</span>x <span class="sc">-</span> <span class="fl">0.5</span>) <span class="sc">*</span> <span class="dv">2</span></span>
<span id="cb55-5"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-6"><a href="" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span></span>
<span id="cb55-7"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y=</span>y)) <span class="sc">+</span></span>
<span id="cb55-8"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>x), <span class="at">color=</span><span class="st">"blue"</span>, <span class="at">linewidth=</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb55-9"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>x2), <span class="at">color=</span><span class="st">"orange"</span>, <span class="at">linewidth=</span><span class="dv">2</span>, <span class="at">alpha=</span><span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb55-10"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.2</span>, <span class="fl">1.2</span>)) <span class="sc">+</span></span>
<span id="cb55-11"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="index_files/figure-revealjs/unnamed-chunk-33-1.png" width="3000"></p>
</figure>
</div>
</div>
</div>
</div>
<ul>
<li class="fragment">Original distribution in blue and shifted and scaled in orange</li>
</ul>
</div>
</div>
</section>
<section id="meaning" class="slide level2">
<h2>Meaning</h2>

<img data-src="index_files/figure-revealjs/unnamed-chunk-34-1.png" width="3000" class="r-stretch"><ul>
<li class="fragment">This means that we think that the correlation coefficient is more likely to be 0, and then “gradually” less likely as we move away from 0, with very low likelihood for values close to -1 or 1</li>
</ul>
</section>
<section id="bayesfactors-defaults" class="slide level2">
<h2>BayesFactor’s defaults</h2>
<ul>
<li class="fragment">What does <code>BayesFactor</code> use?</li>
<li class="fragment">We can read the documentation of <code>correlationBF</code> to find out</li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="" aria-hidden="true" tabindex="-1"></a>?BayesFactor<span class="sc">::</span>correlationBF</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<blockquote>
<p>Noninformative priors are assumed for the population means and variances of the two population; <strong>a shifted, scaled beta(1/rscale,1/rscale) prior distribution is assumed for <span class="math inline">\(rho\)</span></strong> […]</p>
</blockquote>
</div>
<div class="fragment">
<blockquote>
<p>For the rscale argument, several named values are recognized: “medium.narrow”, “medium” [default], “wide”, and “ultrawide”. These correspond to r scale values of <span class="math inline">\(1/\sqrt{27}\)</span>, 1/3, <span class="math inline">\(1/\sqrt{3}\)</span>, and <span class="math inline">\(1\)</span>, respectively.</p>
</blockquote>
</div>
</section>
<section id="visualize-bayesfactors-defaults" class="slide level2">
<h2>Visualize BayesFactor’s defaults</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># List of rscales</span></span>
<span id="cb57-2"><a href="" aria-hidden="true" tabindex="-1"></a>rscales <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb57-3"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="st">"medium.narrow"</span> <span class="ot">=</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">27</span>),</span>
<span id="cb57-4"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="st">"medium"</span> <span class="ot">=</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>,</span>
<span id="cb57-5"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="st">"wide"</span> <span class="ot">=</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">3</span>),</span>
<span id="cb57-6"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="st">"ultrawide"</span> <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb57-7"><a href="" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the beta distribution following the formula </span></span>
<span id="cb58-2"><a href="" aria-hidden="true" tabindex="-1"></a><span class="co"># And store in the same dataframe</span></span>
<span id="cb58-3"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-4"><a href="" aria-hidden="true" tabindex="-1"></a>xspace <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by=</span><span class="fl">0.01</span>)  <span class="co"># Original beta is ]0, 1[</span></span>
<span id="cb58-5"><a href="" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-6"><a href="" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()  <span class="co"># Inititalize empty dataframe</span></span>
<span id="cb58-7"><a href="" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(scale <span class="cf">in</span> <span class="fu">names</span>(rscales)) {</span>
<span id="cb58-8"><a href="" aria-hidden="true" tabindex="-1"></a>  rscale <span class="ot">&lt;-</span> rscales[[scale]]</span>
<span id="cb58-9"><a href="" aria-hidden="true" tabindex="-1"></a>  dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb58-10"><a href="" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">dbeta</span>(xspace, <span class="dv">1</span><span class="sc">/</span>rscale, <span class="dv">1</span><span class="sc">/</span>rscale),</span>
<span id="cb58-11"><a href="" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> (xspace <span class="sc">-</span> <span class="fl">0.5</span>) <span class="sc">*</span> <span class="dv">2</span>, <span class="co"># Rescale its x-axis</span></span>
<span id="cb58-12"><a href="" aria-hidden="true" tabindex="-1"></a>    <span class="at">scale =</span> scale</span>
<span id="cb58-13"><a href="" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb58-14"><a href="" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(data, dat)</span>
<span id="cb58-15"><a href="" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div><div class="column" style="width:50%;">
<ul>
<li class="fragment">Exercice: plot that!</li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> </span>
<span id="cb59-2"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y)) <span class="sc">+</span></span>
<span id="cb59-3"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color=</span>scale), <span class="at">linewidth=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb59-4"><a href="" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.2</span>, <span class="fl">1.2</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="index_files/figure-revealjs/unnamed-chunk-38-1.png" width="3000"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="priors-impact-bayes-factors" class="slide level2">
<h2>Priors impact Bayes Factors</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li class="fragment">The prior we choose has an impact on the Bayes Factor</li>
</ul>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="" aria-hidden="true" tabindex="-1"></a>BayesFactor<span class="sc">::</span><span class="fu">correlationBF</span>(mtcars<span class="sc">$</span>drat, mtcars<span class="sc">$</span>qsec, </span>
<span id="cb60-2"><a href="" aria-hidden="true" tabindex="-1"></a>                           <span class="at">rscale=</span><span class="st">"medium.narrow"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Bayes factor analysis
--------------
[1] Alt., r=0.192 : 0.5409961 ±0%

Against denominator:
  Null, rho = 0 
---
Bayes factor type: BFcorrelation, Jeffreys-beta*</code></pre>
</div>
</div>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="" aria-hidden="true" tabindex="-1"></a>BayesFactor<span class="sc">::</span><span class="fu">correlationBF</span>(mtcars<span class="sc">$</span>drat, mtcars<span class="sc">$</span>qsec, </span>
<span id="cb62-2"><a href="" aria-hidden="true" tabindex="-1"></a>                           <span class="at">rscale=</span><span class="st">"medium"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Bayes factor analysis
--------------
[1] Alt., r=0.333 : 0.4322745 ±0%

Against denominator:
  Null, rho = 0 
---
Bayes factor type: BFcorrelation, Jeffreys-beta*</code></pre>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="" aria-hidden="true" tabindex="-1"></a>BayesFactor<span class="sc">::</span><span class="fu">correlationBF</span>(mtcars<span class="sc">$</span>drat, mtcars<span class="sc">$</span>qsec, </span>
<span id="cb64-2"><a href="" aria-hidden="true" tabindex="-1"></a>                           <span class="at">rscale=</span><span class="st">"wide"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Bayes factor analysis
--------------
[1] Alt., r=0.577 : 0.3330176 ±0%

Against denominator:
  Null, rho = 0 
---
Bayes factor type: BFcorrelation, Jeffreys-beta*</code></pre>
</div>
</div>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="" aria-hidden="true" tabindex="-1"></a>BayesFactor<span class="sc">::</span><span class="fu">correlationBF</span>(mtcars<span class="sc">$</span>drat, mtcars<span class="sc">$</span>qsec, </span>
<span id="cb66-2"><a href="" aria-hidden="true" tabindex="-1"></a>                           <span class="at">rscale=</span><span class="st">"ultrawide"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Bayes factor analysis
--------------
[1] Alt., r=1 : 0.2473768 ±0%

Against denominator:
  Null, rho = 0 
---
Bayes factor type: BFcorrelation, Jeffreys-beta*</code></pre>
</div>
</div>
</div>
<ul>
<li class="fragment">The Bayes Factor is sensitive to the choice of prior</li>
<li class="fragment">In this case, the wider the prior, the lower the Bayes factor
<ul>
<li class="fragment">Why?</li>
</ul></li>
<li class="fragment">It’s not <strong>always</strong> the case</li>
</ul>
</div>
</div>
</section>
<section id="misconceptions-about-bayes-factors" class="slide level2">
<h2>Misconceptions about Bayes Factors</h2>
<ul>
<li class="fragment">BFs do <strong>not</strong> tell us the absolute probability of a hypothesis being true. It quantifies how much we should <strong>update</strong> our belief in a hypothesis. If this hypothesis was extremely unlikely, then we might still believe it to be very unlikely, even after computing a large BF.</li>
<li class="fragment">BFs provide <strong>relative</strong> evidence between 2 hypotheses, and it is possible that one hypothesis is supported more than another hypothesis, while both hypotheses are false. Saying <em>“BF shows evidence for the null (H0)”</em> is incorrect. It should be <em>“BF shows evidence for the H0 as compared to H1”</em> (what H1 is matters).</li>
<li class="fragment">BFs tell us nothing about the size of effects.</li>
</ul>
<div class="columns">
<div class="column" style="width:30%;">
<ul>
<li class="fragment">See <a href="https://lakens.github.io/statistical_inferences/04-bayes.html#sec-bfgmisconceptions">Lakens’ post</a> for details</li>
<li class="fragment">See <a href="https://journals.sagepub.com/doi/epub/10.1177/25152459231213371">Tendeiro et al.&nbsp;(2024)</a></li>
</ul>
</div><div class="column" style="width:70%;">
<div class="fragment">
<p><img data-src="img/misuse.png"></p>
</div>
</div>
</div>
</section>
<section id="bayes-factors-summary" class="slide level2">
<h2>Bayes Factors: Summary</h2>
<div style="font-size: 90%">
<ul>
<li class="fragment">Bayes factor are <strong>intuitive</strong> indices measuring of the strength of evidence for one hypothesis over another
<ul>
<li class="fragment">They have a natural interpretation in terms of odds (e.g., 3:1 odds), and have wide applications (comparing models, null-hypothesis testing, …)</li>
<li class="fragment">They have well established interpretation guidelines (&gt; 3; &gt; 10; &gt; 30; &gt; 100)</li>
</ul></li>
<li class="fragment">They are “easy” to compute for simple statistical tests, but for more complex models, they are notoriously hard to compute</li>
<li class="fragment">The fact that they are highly sensitive to the choice of priors + the fact that finding an “alternative” model is not at all trivial + that computing them is often very hard have been seen as <strong>limitations</strong> and made them the focal point of debates (even between Bayesians)</li>
<li class="fragment">There are different schools:
<ul>
<li class="fragment">Some Bayesians believe that BFs are the best indices ever (assuming one understands them) and the Graal of Bayesian statistics</li>
<li class="fragment">Some believe that other indices are better and that BFs reproduce the same culture of binary thinking as Frequentist NHST</li>
<li class="fragment">We’ll adopt a middle view: BFs are useful, in particular for simple tests, but they are not the only good thing in Bayesian statistics</li>
</ul></li>
</ul>
</div>
</section>
<section id="exercice-3" class="slide level2" data-background-color="#FFAB91">
<h2>Exercice</h2>
<ul>
<li class="fragment">Compute and report the Bayes Factor for the correlation between <code>Sepal.Length</code> and <code>Sepal.Width</code> from the <code>iris</code> dataset.</li>
</ul>
</section>
<section id="recap-1" class="slide level2">
<h2>Recap</h2>
<ul>
<li class="fragment"><span class="math inline">\(\underbrace{\frac{P(H_1 | D)}{P(H_0 | D)}}_{posterior} = \underbrace{\frac{P(D | H_1)}{P(D | H_0)}}_{Bayes~Factor} \cdot \underbrace{\frac{P(H_1)}{P(H_0)}}_{prior}\)</span></li>
<li class="fragment">We have seen what Bayes Factors are</li>
<li class="fragment">We have seen how we can place <em>priors</em> on parameters (e.g., for correlations)</li>
<li class="fragment">But… what about the <em>posterior</em>?</li>
</ul>
</section>
<section id="the-end-for-now" class="slide level2 center" data-background-color="#212121">
<h2>The End <sub><sup>(for now)</sup></sub></h2>
<p><em>Thank you!</em></p>
<div class="quarto-auto-generated-content">
<p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/34/University_of_Sussex_Logo.svg/480px-University_of_Sussex_Logo.svg.png" class="slide-logo"></p>
<div class="footer footer-default">

</div>
</div>
</section>

    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="index_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="index_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="index_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="index_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="index_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="index_files/libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="index_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="index_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="index_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="index_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="index_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>